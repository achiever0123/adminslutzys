{"ast":null,"code":"import React from \"react\";\nvar __jsx = React.createElement;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/* eslint-disable no-multiple-empty-lines */\nimport { PureComponent } from 'react';\nimport { Menu } from 'antd';\nimport Link from 'next/link';\nimport Router from 'next/router';\nexport class SiderMenu extends PureComponent {\n  constructor(...args) {\n    super(...args);\n\n    _defineProperty(this, \"state\", {\n      openKeys: []\n    });\n\n    _defineProperty(this, \"onOpenChange\", openKeys => {\n      const {\n        menus\n      } = this.props;\n      const rootSubmenuKeys = menus.filter(_ => !_.menuParentId).map(_ => _.id);\n      const latestOpenKey = openKeys.find(key => openKeys.indexOf(key) === -1);\n      let newOpenKeys = openKeys;\n\n      if (rootSubmenuKeys.indexOf(latestOpenKey) !== -1) {\n        newOpenKeys = latestOpenKey ? [latestOpenKey] : [];\n      }\n\n      this.setState({\n        openKeys: newOpenKeys\n      });\n    });\n\n    _defineProperty(this, \"generateMenus\", data => data.map(item => {\n      if (item.children) {\n        return __jsx(Menu.SubMenu, {\n          key: item.id,\n          title: __jsx(React.Fragment, null, item.icon, __jsx(\"span\", null, item.name))\n        }, this.generateMenus(item.children));\n      }\n\n      return __jsx(Menu.Item, {\n        key: item.id\n      }, item.icon, __jsx(Link, {\n        href: item.route,\n        as: item.as || item.route\n      }, __jsx(\"a\", null, item.name)));\n    }));\n  }\n\n  componentDidMount() {\n    // Router.events.on('routeChangeStart', this.routerChange.bind(this));\n    const {\n      menus\n    } = this.props;\n    const openKeys = this.getOpenKeys(menus);\n    this.setState({\n      openKeys\n    });\n  }\n\n  getOpenKeys(menus) {\n    const pathname = false ? Router.pathname : '';\n    const withoutQuery = pathname.split('?')[0];\n    let found = false;\n    let results = []; // TODO - optimize me if needed or more level\n\n    menus.forEach(menu => {\n      if (found) return;\n      const menuRoute = menu.route ? menu.route.split('?')[0] : '';\n\n      if (menu.route === pathname || menuRoute === withoutQuery) {\n        found = true;\n        results = [menu.id];\n        return;\n      }\n\n      if (menu.children) {\n        menu.children.forEach(cmenu => {\n          if (found) return;\n          const menuRoutes = cmenu.route ? cmenu.route.split('?')[0] : '';\n\n          if (cmenu.route === pathname || menuRoutes === withoutQuery) {\n            found = true;\n            results = [menu.id];\n          }\n        });\n      }\n    });\n    return results;\n  }\n\n  flatten(menus, flattenMenus = []) {\n    menus.forEach(m => {\n      if (m.children) {\n        this.flatten(m.children, flattenMenus);\n      }\n\n      const tmp = _objectSpread({}, m);\n\n      delete tmp.children;\n      flattenMenus.push(tmp);\n    });\n    return flattenMenus;\n  }\n\n  render() {\n    const {\n      theme,\n      menus,\n      collapsed\n    } = this.props;\n    const {\n      openKeys\n    } = this.state;\n    const menuProps = collapsed ? {} : {\n      openKeys\n    };\n    return __jsx(Menu, _extends({\n      mode: \"inline\",\n      theme: theme // selectedKeys={this.state.selectedKeys}\n      ,\n      openKeys: openKeys,\n      onOpenChange: this.onOpenChange.bind(this) // onClick={\n      //   isMobile\n      //     ? () => {\n      //         onCollapseChange(true);\n      //       }\n      //     : undefined\n      // }\n\n    }, menuProps), this.generateMenus(menus));\n  }\n\n}","map":{"version":3,"sources":["/Volumes/Chorus/__Code Source/Slutzys/creator site/admin/src/components/common/layout/menu.tsx"],"names":["PureComponent","Menu","Link","Router","SiderMenu","openKeys","menus","props","rootSubmenuKeys","filter","_","menuParentId","map","id","latestOpenKey","find","key","indexOf","newOpenKeys","setState","data","item","children","icon","name","generateMenus","route","as","componentDidMount","getOpenKeys","pathname","withoutQuery","split","found","results","forEach","menu","menuRoute","cmenu","menuRoutes","flatten","flattenMenus","m","tmp","push","render","theme","collapsed","state","menuProps","onOpenChange","bind"],"mappings":"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","sourcesContent":["/* eslint-disable no-multiple-empty-lines */\nimport { PureComponent } from 'react';\nimport { Menu } from 'antd';\nimport Link from 'next/link';\nimport Router from 'next/router';\n\ninterface IProps {\n  theme?: string;\n  isMobile?: boolean;\n  menus?: any;\n  collapsed?: boolean;\n}\n\nexport class SiderMenu extends PureComponent<IProps> {\n  state = {\n    openKeys: []\n  };\n\n  componentDidMount() {\n    // Router.events.on('routeChangeStart', this.routerChange.bind(this));\n    const { menus } = this.props;\n    const openKeys = this.getOpenKeys(menus);\n    this.setState({ openKeys });\n  }\n\n  onOpenChange = (openKeys) => {\n    const { menus } = this.props;\n    const rootSubmenuKeys = menus.filter((_) => !_.menuParentId).map((_) => _.id);\n\n    const latestOpenKey = openKeys.find(\n      (key) => openKeys.indexOf(key) === -1\n    );\n\n    let newOpenKeys = openKeys;\n    if (rootSubmenuKeys.indexOf(latestOpenKey) !== -1) {\n      newOpenKeys = latestOpenKey ? [latestOpenKey] : [];\n    }\n    this.setState({\n      openKeys: newOpenKeys\n    });\n  }\n\n  getOpenKeys(menus: any) {\n    const pathname = process.browser ? Router.pathname : '';\n    const withoutQuery = pathname.split('?')[0];\n    let found = false;\n    let results = [];\n    // TODO - optimize me if needed or more level\n    menus.forEach((menu) => {\n      if (found) return;\n      const menuRoute = menu.route ? menu.route.split('?')[0] : '';\n      if (menu.route === pathname || menuRoute === withoutQuery) {\n        found = true;\n        results = [menu.id];\n        return;\n      }\n      if (menu.children) {\n        menu.children.forEach((cmenu) => {\n          if (found) return;\n          const menuRoutes = cmenu.route ? cmenu.route.split('?')[0] : '';\n          if (cmenu.route === pathname || menuRoutes === withoutQuery) {\n            found = true;\n            results = [menu.id];\n          }\n        });\n      }\n    });\n    return results;\n  }\n\n  generateMenus = (data) => data.map((item) => {\n    if (item.children) {\n      return (\n        <Menu.SubMenu\n          key={item.id}\n          title={(\n            <>\n              {item.icon}\n              <span>{item.name}</span>\n            </>\n            )}\n        >\n          {this.generateMenus(item.children)}\n        </Menu.SubMenu>\n      );\n    }\n    return (\n      <Menu.Item key={item.id}>\n        {item.icon}\n        <Link href={item.route} as={item.as || item.route}>\n          <a>{item.name}</a>\n        </Link>\n      </Menu.Item>\n    );\n  })\n\n  flatten(menus, flattenMenus = []) {\n    menus.forEach((m) => {\n      if (m.children) {\n        this.flatten(m.children, flattenMenus);\n      }\n      const tmp = { ...m };\n      delete tmp.children;\n      flattenMenus.push(tmp);\n    });\n\n    return flattenMenus;\n  }\n\n  render() {\n    const { theme, menus, collapsed } = this.props;\n    const { openKeys } = this.state;\n    const menuProps = collapsed\n      ? {}\n      : {\n        openKeys\n      };\n    return (\n      <Menu\n        mode=\"inline\"\n        theme={theme as any}\n        // selectedKeys={this.state.selectedKeys}\n        openKeys={openKeys}\n        onOpenChange={this.onOpenChange.bind(this)}\n        // onClick={\n        //   isMobile\n        //     ? () => {\n        //         onCollapseChange(true);\n        //       }\n        //     : undefined\n        // }\n        {...menuProps}\n      >\n        {this.generateMenus(menus)}\n      </Menu>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}