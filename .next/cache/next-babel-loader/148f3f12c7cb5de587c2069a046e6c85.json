{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _assertThisInitialized from \"@babel/runtime/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport React from \"react\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) { symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); } keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\n/* eslint-disable no-multiple-empty-lines */\nimport { PureComponent } from 'react';\nimport { Menu } from 'antd';\nimport Link from 'next/link';\nimport Router from 'next/router';\nexport var SiderMenu = /*#__PURE__*/function (_PureComponent) {\n  _inherits(SiderMenu, _PureComponent);\n\n  var _super = _createSuper(SiderMenu);\n\n  function SiderMenu() {\n    var _this;\n\n    _classCallCheck(this, SiderMenu);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _defineProperty(_assertThisInitialized(_this), \"state\", {\n      openKeys: []\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onOpenChange\", function (openKeys) {\n      var menus = _this.props.menus;\n      var rootSubmenuKeys = menus.filter(function (_) {\n        return !_.menuParentId;\n      }).map(function (_) {\n        return _.id;\n      });\n      var latestOpenKey = openKeys.find(function (key) {\n        return openKeys.indexOf(key) === -1;\n      });\n      var newOpenKeys = openKeys;\n\n      if (rootSubmenuKeys.indexOf(latestOpenKey) !== -1) {\n        newOpenKeys = latestOpenKey ? [latestOpenKey] : [];\n      }\n\n      _this.setState({\n        openKeys: newOpenKeys\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"generateMenus\", function (data) {\n      return data.map(function (item) {\n        if (item.children) {\n          return __jsx(Menu.SubMenu, {\n            key: item.id,\n            title: __jsx(React.Fragment, null, item.icon, __jsx(\"span\", null, item.name))\n          }, _this.generateMenus(item.children));\n        }\n\n        return __jsx(Menu.Item, {\n          key: item.id\n        }, item.icon, __jsx(Link, {\n          href: item.route,\n          as: item.as || item.route\n        }, __jsx(\"a\", null, item.name)));\n      });\n    });\n\n    return _this;\n  }\n\n  _createClass(SiderMenu, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // Router.events.on('routeChangeStart', this.routerChange.bind(this));\n      var menus = this.props.menus;\n      var openKeys = this.getOpenKeys(menus);\n      this.setState({\n        openKeys: openKeys\n      });\n    }\n  }, {\n    key: \"getOpenKeys\",\n    value: function getOpenKeys(menus) {\n      var pathname = true ? Router.pathname : '';\n      var withoutQuery = pathname.split('?')[0];\n      var found = false;\n      var results = []; // TODO - optimize me if needed or more level\n\n      menus.forEach(function (menu) {\n        if (found) return;\n        var menuRoute = menu.route ? menu.route.split('?')[0] : '';\n\n        if (menu.route === pathname || menuRoute === withoutQuery) {\n          found = true;\n          results = [menu.id];\n          return;\n        }\n\n        if (menu.children) {\n          menu.children.forEach(function (cmenu) {\n            if (found) return;\n            var menuRoutes = cmenu.route ? cmenu.route.split('?')[0] : '';\n\n            if (cmenu.route === pathname || menuRoutes === withoutQuery) {\n              found = true;\n              results = [menu.id];\n            }\n          });\n        }\n      });\n      return results;\n    }\n  }, {\n    key: \"flatten\",\n    value: function flatten(menus) {\n      var _this2 = this;\n\n      var flattenMenus = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n      menus.forEach(function (m) {\n        if (m.children) {\n          _this2.flatten(m.children, flattenMenus);\n        }\n\n        var tmp = _objectSpread({}, m);\n\n        delete tmp.children;\n        flattenMenus.push(tmp);\n      });\n      return flattenMenus;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props = this.props,\n          theme = _this$props.theme,\n          menus = _this$props.menus,\n          collapsed = _this$props.collapsed;\n      var openKeys = this.state.openKeys;\n      var menuProps = collapsed ? {} : {\n        openKeys: openKeys\n      };\n      return __jsx(Menu, _extends({\n        mode: \"inline\",\n        theme: theme // selectedKeys={this.state.selectedKeys}\n        ,\n        openKeys: openKeys,\n        onOpenChange: this.onOpenChange.bind(this) // onClick={\n        //   isMobile\n        //     ? () => {\n        //         onCollapseChange(true);\n        //       }\n        //     : undefined\n        // }\n\n      }, menuProps), this.generateMenus(menus));\n    }\n  }]);\n\n  return SiderMenu;\n}(PureComponent);","map":{"version":3,"sources":["/Volumes/Chorus/__Code Source/Slutzys/creator site/admin/src/components/common/layout/menu.tsx"],"names":["PureComponent","Menu","Link","Router","SiderMenu","openKeys","menus","props","rootSubmenuKeys","filter","_","menuParentId","map","id","latestOpenKey","find","key","indexOf","newOpenKeys","setState","data","item","children","icon","name","generateMenus","route","as","getOpenKeys","pathname","withoutQuery","split","found","results","forEach","menu","menuRoute","cmenu","menuRoutes","flattenMenus","m","flatten","tmp","push","theme","collapsed","state","menuProps","onOpenChange","bind"],"mappings":"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","sourcesContent":["/* eslint-disable no-multiple-empty-lines */\nimport { PureComponent } from 'react';\nimport { Menu } from 'antd';\nimport Link from 'next/link';\nimport Router from 'next/router';\n\ninterface IProps {\n  theme?: string;\n  isMobile?: boolean;\n  menus?: any;\n  collapsed?: boolean;\n}\n\nexport class SiderMenu extends PureComponent<IProps> {\n  state = {\n    openKeys: []\n  };\n\n  componentDidMount() {\n    // Router.events.on('routeChangeStart', this.routerChange.bind(this));\n    const { menus } = this.props;\n    const openKeys = this.getOpenKeys(menus);\n    this.setState({ openKeys });\n  }\n\n  onOpenChange = (openKeys) => {\n    const { menus } = this.props;\n    const rootSubmenuKeys = menus.filter((_) => !_.menuParentId).map((_) => _.id);\n\n    const latestOpenKey = openKeys.find(\n      (key) => openKeys.indexOf(key) === -1\n    );\n\n    let newOpenKeys = openKeys;\n    if (rootSubmenuKeys.indexOf(latestOpenKey) !== -1) {\n      newOpenKeys = latestOpenKey ? [latestOpenKey] : [];\n    }\n    this.setState({\n      openKeys: newOpenKeys\n    });\n  }\n\n  getOpenKeys(menus: any) {\n    const pathname = process.browser ? Router.pathname : '';\n    const withoutQuery = pathname.split('?')[0];\n    let found = false;\n    let results = [];\n    // TODO - optimize me if needed or more level\n    menus.forEach((menu) => {\n      if (found) return;\n      const menuRoute = menu.route ? menu.route.split('?')[0] : '';\n      if (menu.route === pathname || menuRoute === withoutQuery) {\n        found = true;\n        results = [menu.id];\n        return;\n      }\n      if (menu.children) {\n        menu.children.forEach((cmenu) => {\n          if (found) return;\n          const menuRoutes = cmenu.route ? cmenu.route.split('?')[0] : '';\n          if (cmenu.route === pathname || menuRoutes === withoutQuery) {\n            found = true;\n            results = [menu.id];\n          }\n        });\n      }\n    });\n    return results;\n  }\n\n  generateMenus = (data) => data.map((item) => {\n    if (item.children) {\n      return (\n        <Menu.SubMenu\n          key={item.id}\n          title={(\n            <>\n              {item.icon}\n              <span>{item.name}</span>\n            </>\n            )}\n        >\n          {this.generateMenus(item.children)}\n        </Menu.SubMenu>\n      );\n    }\n    return (\n      <Menu.Item key={item.id}>\n        {item.icon}\n        <Link href={item.route} as={item.as || item.route}>\n          <a>{item.name}</a>\n        </Link>\n      </Menu.Item>\n    );\n  })\n\n  flatten(menus, flattenMenus = []) {\n    menus.forEach((m) => {\n      if (m.children) {\n        this.flatten(m.children, flattenMenus);\n      }\n      const tmp = { ...m };\n      delete tmp.children;\n      flattenMenus.push(tmp);\n    });\n\n    return flattenMenus;\n  }\n\n  render() {\n    const { theme, menus, collapsed } = this.props;\n    const { openKeys } = this.state;\n    const menuProps = collapsed\n      ? {}\n      : {\n        openKeys\n      };\n    return (\n      <Menu\n        mode=\"inline\"\n        theme={theme as any}\n        // selectedKeys={this.state.selectedKeys}\n        openKeys={openKeys}\n        onOpenChange={this.onOpenChange.bind(this)}\n        // onClick={\n        //   isMobile\n        //     ? () => {\n        //         onCollapseChange(true);\n        //       }\n        //     : undefined\n        // }\n        {...menuProps}\n      >\n        {this.generateMenus(menus)}\n      </Menu>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}